(function(){function a(){this.w&&this.w.addEventListener("click",this.close.bind(this));this.a&&this.a.addEventListener("click",this.close.bind(this));document.getElementById("bch-open").addEventListener("click",function(){this.innerHTML="<span>Opening Bitcoin Cash Wallet</span>"})}Modal.prototype.close=function(){clearInterval(f);var a=this;this.b.className=this.b.className.replace(" paybutton-open","");this.a.className=this.a.className.replace(" paybutton-open","");this.b.addEventListener(this.C,
function(){a.b.parentNode.removeChild(a.b)});this.a.addEventListener(this.C,function(){a.a.parentNode&&a.a.parentNode.removeChild(a.a)})};Modal.prototype.open=function(){var c="string"===typeof this.options.content?this.options.content:this.options.content.innerHTML;var b=document.createDocumentFragment();this.b=document.createElement("div");this.b.className="paybutton-modal "+this.options.className;!0===this.options.a&&(this.a=document.createElement("div"),this.a.className="paybutton-overlay "+this.options.className,
b.appendChild(this.a));var d=document.createElement("div");d.className="paybutton-content";d.id="modal-content";d.innerHTML=c;this.b.appendChild(d);b.appendChild(this.b);document.body.appendChild(b);a.call(this);window.getComputedStyle(this.b).height;this.b.className+=this.b.offsetHeight>window.innerHeight?" paybutton-open paybutton-anchored":" paybutton-open";this.a.className+=" paybutton-open"}})();var f;function h(a){a.timeStamp=Math.floor(Date.now()/1E3);f=setInterval(function(){k(a)},1400)}
function k(a){var c=new XMLHttpRequest;c.open("GET","https://rest.bitcoin.com/v2/address/unconfirmed/"+a.o,!0);c.onload=function(){if(4==c.readyState&&200==c.status){console.log("listening for transaction..");for(var b=JSON.parse(c.responseText),d=0;d<b.D.length;d++){var g=b.D[d];if(a.timeStamp<g.L&&g.F==a.f){clearInterval(f);a.g=g.g;b=a;d=new Audio("https://paybutton.cash/pre-release/v0.1/audio/pbding.mp3");d.volume=.02;d.play();b.m||(b.m="Transaction Successful!");document.getElementById("modal-content").innerHTML=
'<div><div><div class="txdialoguediv"><div><span>'+b.m+'</span></div></div><div class="txdialoguediv"><div><span>View: </span><a href="https://explorer.bitcoin.com/bch/tx/'+b.g+'" target="_blank" style="color: orangeRed; text-decoration: none;">Transaction</a></div></div></div></div>';console.log("Confirmed. Transaction ID:",b.g);if(d=document.getElementsByClassName(b.A))for(g=0;g<d.length;g++)d[g].style.display="block";if(b.l&&window[b.l])window[b.l](b.g);break}}}else console.log("Found Server But There Is An Error")};
c.onerror=function(){console.log("Could Not Connect To Server")};c.send()}
function l(a){a.u?(a.h="Send any amount of Bitcoin Cash",a.c=a.o):(a.c=a.o+"?amount="+a.f,h(a));var c={G:"Q",fillcolor:"#FFFFFF",K:"#000000",margin:"0.5",J:12};document.implementation.hasFeature("http://www.w3.org/2000/svg","1.1")?(genQR=QRCode.I(a.c,c),genQR=(new XMLSerializer).serializeToString(genQR),genQR="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(genQR)))):genQR=QRCode.H(a.c,c);qrImage=genQR;(new Modal({content:'<div><div><div><div class="qrparent" onclick=copyBCHURI(\''+a.c+
'\')><img class="qrcode" src="'+qrImage+'" /><img class="qricon" src="https://paybutton.cash/images/bitcoincash_bare_logo.png" /><div id="copyDiv" class="qrctc">Click to Copy</div></div></div><div class="dialoguediv"><div><span>'+a.h+'</span></div> </div><div><div><button id="bch-open" class="pay-button modal" onclick="location.href=\''+a.c+'\'" type="button"><span>Send with BCH Wallet</span></button></div></div><div class="poweredbydiv"><div><span><a href="https://paybutton.cash" target="_blank" style="color: orangeRed; text-decoration: none;">Powered by PayButton.cash</a></span></div></div></div></div>'})).open()}
function m(a){var c=new XMLHttpRequest;c.open("GET","https://index-api.bitcoin.com/api/v0/cash/price/"+a.s,!0);c.onload=function(){if(4==c.readyState&&200==c.status){var b=JSON.parse(c.responseText);""!=b.B?(a.j=(1/(b.B/100)*a.v).toFixed(8),a.i=(Math.random()*(1.23E-6-1E-7)+1E-7).toFixed(8),a.f=(Number(a.j)+Number(a.i)).toFixed(8),a.h=a.v+" "+a.s+" = "+a.f+" BCH",l(a)):console.log("Error Price Not Found")}else console.log("Found Server But There Is An Error")};c.onerror=function(){console.log("Could Not Connect To Server")};
c.send()}function q(){var a=this.getAttribute("button-text-2")||"";a=a.trim();if(!a){var c=this.getAttribute("amount")||"";c=Number(c.trim());var b=this.getAttribute("amount-type")||"";b=b.trim().toUpperCase();a=c+" "+b;c&&b||(a="Click to send BCH")}this.innerHTML="<span>&nbsp</span>";var d=this;setTimeout(function(){d.innerHTML="<span>"+a+"</span>"},200);"ontouchend"in window||this.addEventListener("mouseleave",r,!1);"ontouchend"in window&&this.addEventListener("touchend",r,!1)}
function r(){var a=this.getAttribute("button-text")||"";a=a.trim();if(!a){var c=this.getAttribute("amount")||"";c=Number(c.trim());var b=this.getAttribute("amount-type")||"";b=b.trim().toUpperCase();a="Send Bitcoin Cash";c&&b||(a="Send Bitcoin Cash")}this.innerHTML="<span>&nbsp</span>";var d=this;setTimeout(function(){d.innerHTML="<span>"+a+"</span>"},200)}
document.addEventListener("DOMContentLoaded",function(){for(var a=document.getElementsByClassName("pay-button"),c=0;c<a.length;c++){var b=a[c];window.addEventListener("load",r.bind(b),!1);"ontouchstart"in window||b.addEventListener("mouseenter",q,!1);"ontouchstart"in window&&b.addEventListener("touchstart",q,!1);b.addEventListener("click",function(){var a=this.getAttribute("amount")||"";a=Number(a.trim());var b=this.getAttribute("amount-type")||"";b=b.trim().toUpperCase();var c=this.getAttribute("address")||
"";c=c.trim();var e=this.getAttribute("success-msg")||"";e=e.trim();var n=this.getAttribute("paywall-field")||"";n=n.trim();var p=this.getAttribute("success-callback")||"";p=p.trim();e={v:a,s:b,o:c,m:e,A:n,l:p};if(c){if(a||b){if(!a||!b){alert('PayButton Error:\n\nFor specific PayButton amounts, BOTH of the following MUST be set:\n\n1. amount (Must be a number)\n2. amount-type (Can be BCH, Satoshi, USD, AUD etc)\n\nTo allow "Any" amount, BOTH must be blank.');return}}else e.u=!0;e.u?l(e):"BCH"==b||
"SATOSHI"==b?("SATOSHI"==b&&(a/=1E8),e.j=a.toFixed(8),e.i=(Math.random()*(1.23E-6-1E-7)+1E-7).toFixed(8),b=Number(e.j)+Number(e.i),e.f=b.toFixed(8),e.h="Amount = "+e.f+" BCH",l(e)):m(e)}else alert("PayButton Error:\n\nBelow are the minimum button requirements\n\n1. address (Bitcoin Cash address)")})}});if(!document.getElementById("pbQR")){var t=document.getElementsByTagName("head")[0],u=document.createElement("script");u.src="https://paybutton.cash/pre-release/v0.1/js/qrjs2.min.js";u.id="pbQR";t.appendChild(u)}
if(!document.getElementById("pbButtonCSS")){t=document.getElementsByTagName("head")[0];var v=document.createElement("link");v.rel="stylesheet";v.type="text/css";v.href="https://paybutton.cash/pre-release/v0.1/css/buttons.min.css";v.id="pbButtonCSS";v.media="all";t.appendChild(v)}
document.getElementById("pbModalCSS")||(t=document.getElementsByTagName("head")[0],v=document.createElement("link"),v.rel="stylesheet",v.type="text/css",v.href="https://paybutton.cash/pre-release/v0.1/css/modal.min.css",v.id="pbModalCSS",v.media="all",t.appendChild(v));
